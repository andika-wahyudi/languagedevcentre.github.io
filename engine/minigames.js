export class MiniGames { constructor(){ this.active = null; } start(name, canvas){ if(name==='reaction'){ this.active = new ReactionGame(canvas); } } exit(){ this.active = null; } update(dt){ if(this.active) this.active.update(dt); } draw(){ if(this.active) this.active.draw(); } } class ReactionGame { constructor(canvas){ this.canvas=canvas; this.ctx=canvas.getContext('2d'); this.state='waiting'; this.timer=0; this.promptDelay = 1 + Math.random()*2; this.reactionTime = null; window.addEventListener('keydown', this.keyHandler); } keyHandler = (e)=>{ if(e.key===' '){ if(this.state==='go'){ this.reactionTime = this.timer; this.state='done'; } else if(this.state==='waiting'){ this.state='failed'; } } }; update(dt){ if(this.state==='waiting'){ this.timer += dt; if(this.timer >= this.promptDelay){ this.timer=0; this.state='go'; } } else if(this.state==='go'){ this.timer += dt; } } draw(){ const c=this.ctx; c.clearRect(0,0,this.canvas.width,this.canvas.height); c.fillStyle='#111'; c.fillRect(0,0,this.canvas.width,this.canvas.height); c.fillStyle='white'; c.font='16px monospace'; c.textAlign='center'; c.fillText('Reaction Mini-Game', this.canvas.width/2, 30); if(this.state==='waiting') c.fillText('Wait for GO...', this.canvas.width/2, 90); else if(this.state==='go') c.fillText('SPACE!', this.canvas.width/2, 90); else if(this.state==='done') c.fillText(`Time: ${(this.reactionTime*1000|0)} ms`, this.canvas.width/2, 90); else if(this.state==='failed') c.fillText('Too early!', this.canvas.width/2, 90); } }